from exploit import Exploit

class RawDumperExploit(Exploit):
    def __init__(self):
        Exploit.__init__(self)
        self.empty_exploit = lambda: []

    def do_writemem(self, address, value):
        """Write a pointer-sized buffer to the specfied location."""
        return "", [("write_constant", value, address, None)]

    def write_with_offset(self, pointer_address, offset, value):
        return [("write_with_offset", value, pointer_address, offset)]

    def deref_with_offset_and_save(self, pointer_address, offset, save_address):
        return [("deref_with_offset_and_save", save_address, pointer_address, offset)]

def register_gadget_provider():
    return [("dump", RawDumperExploit)]
